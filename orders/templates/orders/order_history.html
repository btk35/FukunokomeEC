{% extends 'base.html' %}
{% load humanize %}

{% block title %}注文履歴｜ふくのこめ{% endblock %}

{% block sidebar %}
<aside class="col-md-3">
    {% include "profiles/includes/aside_profile.html" %}
</aside>
{% endblock %}

{% block main_col_class %}col-md-9{% endblock %}

{% block main_content %}
<h2>注文履歴</h2>

{% if orders %}
{% for order in orders %}
<section class="border p-3 rounded bg-light mb-4">
    <h5 class="mb-3">注文番号：{{ order.order_number }}</h5>
    
    <dl class="row mb-0">
        <dt class="col-sm-4">注文日</dt>
        <dd class="col-sm-8">{{ order.ordered_at|date:"Y年n月j日 H:i" }}</dd>
        
        <dt class="col-sm-4">合計金額（税込）</dt>
        <dd class="col-sm-8">{{ order.total_price|floatformat:0 | intcomma }} 円</dd>
        
        <dt class="col-sm-4">支払い方法</dt>
        <dd class="col-sm-8">{{ order.get_payment_method_display }}</dd>
        
        <dt class="col-sm-4">支払い状況</dt>
        <dd class="col-sm-8">
            {% if order.payment_status == "paid" %}
                <span class="text-success">{{ order.get_payment_status_display }}</span>
            {% else %}
                <span class="text-danger">{{ order.get_payment_status_display }}</span>
            {% endif %}
        </dd>
        
        <dt class="col-sm-4">発送状況</dt>
        <dd class="col-sm-8">{{ order.get_status_display }}</dd>
        
        <dt class="col-sm-4">配送先</dt>
        <dd class="col-sm-8">
            {{ order.shipping_last_name }} {{ order.shipping_first_name }} /
            {{ order.shipping_postal_code }}<br>
            {{ order.shipping_prefecture }}{{ order.shipping_city }}{{ order.shipping_street_address }}{{ order.shipping_address_detail }}
        </dd>
        
        {% if order.notes %}
        <dt class="col-sm-4">備考</dt>
        <dd class="col-sm-8">{{ order.notes|linebreaksbr }}</dd>
        {% endif %}
    </dl>
</section>
{% endfor %}
{% else %}
<p>過去の注文はありません。</p>
{% endif %}

{% endblock %}
